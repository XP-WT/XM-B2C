(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/goods"],{3657:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n("5df8");function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=function(){return n.e("components/icon/icon").then(n.bind(null,"be58"))},c=function(){return n.e("components/numberbox/numberbox").then(n.bind(null,"e58b"))},a=function(){return n.e("components/rate/rate").then(n.bind(null,"1308"))},r=function(){return n.e("wxcomponents/hch-poster/hch-poster").then(n.bind(null,"9911"))},l=function(){return n.e("components/countdown/countdown").then(n.bind(null,"16ed"))},u={onShareAppMessage:function(t){return"button"===t.from&&console.log(t.target),{title:this.goodsData.name,imageUrl:this.swiperList[0].img,path:"pages/goods/goods?gid="+this.goodsData.id,success:function(t){console.log(t)},fail:function(t){console.log(t)}}},components:{tuiNumberbox:c,tuiRate:a,hchPoster:r,tuiIcon:s,tuiCountdown:l},data:function(){return{id:"",secret:"",timestamp:"",beforeHeaderzIndex:11,afterHeaderzIndex:10,beforeHeaderOpacity:1,afterHeaderOpacity:0,swiperList:[{}],currentSwiper:0,anchorlist:[],selectAnchor:0,serviceClass:"",specClass:"",shareClass:"",goodsData:{id:"",name:"",price:"",disPrice:"",number:1,service:[{name:"7天无忧退货",description:"此商品官方保证7天退货"},{name:"满59包邮",description:"此商品享受满59包邮"},{name:"2个工作日退款",description:"此商品享受退货极速退款服务"},{name:"熙美诚品自营",description:"熙美诚品原创生活类品牌，所有商品均为熙美诚品自营，品质保证"}],spec:["XS","S","M","L","XL","XXL"],comment:{number:0,userface:"../../static/img/face.jpg",username:"未上线",content:"商品评论还未上线，敬请期待！"}},selectSpec:null,isKeep:!1,descriptionStr:"",value:1,current:4,xopenid:"",deliveryFlag:!1,canvasFlag:!0,posterData:{},secShow:!1,endTime:0,secPrice:0,nextShow:!1,startTime:0}},onLoad:function(t){this.showBack=!1;var e=(0,o.getSecret)();this.secret=e.secret,this.timestamp=e.timestamp,this.gid=t.gid,this.getDetails()},onShow:function(){var e=this;t.getStorage({key:"user",success:function(t){e.xopenid=t.data.openid}})},onReady:function(){this.calcAnchor()},onPageScroll:function(t){this.selectAnchor=t.scrollTop>=this.anchorlist[2].top?2:t.scrollTop>=this.anchorlist[1].top?1:0;var e=375;t.scrollTop=t.scrollTop>e?375:t.scrollTop,this.afterHeaderOpacity=t.scrollTop*(1/e),this.beforeHeaderOpacity=1-this.afterHeaderOpacity,this.beforeHeaderzIndex=t.scrollTop>0?10:11,this.afterHeaderzIndex=t.scrollTop>0?11:10},onReachBottom:function(){},mounted:function(){},methods:{getDetails:function(){var t=this,e={id:this.gid};this.$xm.post("/Product/getInfo",e,function(e){var n=e;t.goodsData.id=n.id,t.goodsData.price=n.pro_price,t.goodsData.name=n.pro_name,t.goodsData.disPrice=n.dis_price,t.secPrice=n.sec_price,n.keep?t.isKeep=!0:t.isKeep=!1,n.nextstart?(t.nextShow=!0,t.startTime=parseInt(n.nextstart)-Math.round(new Date/1e3)):t.nextShow=!1,n.etime?(t.secShow=!0,t.endTime=parseInt(n.etime)-Math.round(new Date/1e3)):t.secShow=!1,t.swiperList[0].img="http://ximiphoto.oss-cn-hangzhou.aliyuncs.com/thumb/"+n.pro_sn+".jpg?x-oss-process=style/440",t.descriptionStr='<div style="text-align:center;"><img width="100%" src="http://img.xmvogue.com/detail/'+n.pro_sn+'-.jpg?x-oss-process=style/800"/></div>'})},like:function(){var e=this,n={proid:this.gid};this.$xm.post("/Collect/addcollect",n,function(n){"添加成功!"==n.msg&&(e.isKeep=!0,t.showToast({title:"收藏成功"})),console.log(n)})},dellike:function(){var e,n=this;t.showModal((e={title:"确定取消收藏吗？",content:"",confirmText:"取  消",cancelColor:"#b2b2b2"},i(e,"confirmText","确  定"),i(e,"confirmColor","#2c2c2c"),i(e,"success",function(e){if(e.confirm){var o={id:n.gid};n.$xm.post("/Collect/delcollect",o,function(e){console.log(e),2e3==e.code&&(n.isKeep=!1,t.showToast({title:"删除成功"}))})}}),e))},swiperChange:function(t){this.currentSwiper=t.detail.current},change:function(e){this.value=e.value,console.log(this.value),this.value<1&&(this.value=1,t.showToast({title:"亲，不能再见少了",icon:"none"}))},cart:function(){t.switchTab({url:"../tabBar/cart/cart"})},share:function(){this.shareClass="show"},hideShare:function(){var t=this;this.shareClass="hide",setTimeout(function(){t.shareClass="none"},150)},createCanvasImageEvn:function(){var t=this;this.shareClass="hide",Object.assign(this.posterData,{url:this.swiperList[0].img,title:this.goodsData.name,discountPrice:this.goodsData.disPrice||0,orignPrice:this.goodsData.price,code:"pages/details/details?gid="+this.gid,id:this.gid,close:"../../static/img/close_btn.png"}),this.$forceUpdate(),setTimeout(function(){t.canvasFlag=!1,t.deliveryFlag=!1,t.$refs.hchPoster.createCanvasImage()},500)},canvasCancel:function(t){this.canvasFlag=t,this.getDetails()},joinCart:function(){var e={proid:this.gid,pronum:this.value};this.$xm.post("/Cart/add",e,function(e){var n=e.msg;"加入购物车成功"==n&&t.showToast({title:"已加入购物车"})})},buy:function(){this.joinCart(),this.toConfirmation()},toRatings:function(){t.navigateTo({url:"./ratings/ratings"})},toConfirmation:function(){t.navigateTo({url:"../order/confirmation"})},showComments:function(t){},setSelectSpec:function(t){this.selectSpec=t},sub:function(){this.goodsData.number<=1||this.goodsData.number--},add:function(){this.goodsData.number++},toAnchor:function(e){this.selectAnchor=e,t.pageScrollTo({scrollTop:this.anchorlist[e].top,duration:200})},calcAnchor:function(){var e=this;this.anchorlist=[{name:"主图",top:0},{name:"评价",top:0},{name:"详情",top:0}];var n=t.createSelectorQuery().select("#comments");n.boundingClientRect(function(n){console.log(n);var o=0,i=t.upx2px(100);e.anchorlist[0].top=n.top-i-o,e.anchorlist[1].top=n.bottom-i-o}).exec()},back:function(){t.navigateBack()},showService:function(){this.serviceClass="show"},hideService:function(){var t=this;this.serviceClass="hide",setTimeout(function(){t.serviceClass="none"},200)},showSpec:function(t){this.specClass="show",this.specCallback=t},specCallback:function(){},hideSpec:function(){var t=this;this.specClass="hide",this.selectSpec&&this.specCallback&&this.specCallback(),this.specCallback=!1,setTimeout(function(){t.specClass="none"},200)},discard:function(){}}};e.default=u}).call(this,n("543d")["default"])},"3a6d":function(t,e,n){"use strict";(function(t){n("e146"),n("921b");o(n("66fd"));var e=o(n("ead2"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"49b1":function(t,e,n){"use strict";n.r(e);var o=n("3657"),i=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,function(){return o[t]})}(s);e["default"]=i.a},"5c24":function(t,e,n){"use strict";var o=n("813c"),i=n.n(o);i.a},"813c":function(t,e,n){},"83ae":function(t,e,n){"use strict";var o,i=function(){var t=this,e=t.$createElement;t._self._c},s=[];n.d(e,"b",function(){return i}),n.d(e,"c",function(){return s}),n.d(e,"a",function(){return o})},ead2:function(t,e,n){"use strict";n.r(e);var o=n("83ae"),i=n("49b1");for(var s in i)"default"!==s&&function(t){n.d(e,t,function(){return i[t]})}(s);n("5c24");var c,a=n("f0c5"),r=Object(a["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],c);e["default"]=r.exports}},[["3a6d","common/runtime","common/vendor"]]]);
(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/confirmation"],{"319d":function(t,e,i){"use strict";var s=i("f299"),n=i.n(s);n.a},"3a0d":function(t,e,i){"use strict";i.r(e);var s=i("46cf"),n=i.n(s);for(var o in s)"default"!==o&&function(t){i.d(e,t,function(){return s[t]})}(o);e["default"]=n.a},"46cf":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={data:function(){return{word:[],id:"",secret:{},buylist:[],goodsPrice:0,payPrice:0,payLing:0,sumPrice:0,freight:5,note:"",int:1200,deduction:0,disType:null,disPrice:null,tips:"",minprice:0,recinfo:{},items:[],ship_name:"",shipmoney:"",choose:!1,store:""}},onLoad:function(t){this.store=t.store,console.log(this.store),this.loadData(),this.getAddress()},onShow:function(){var e=this;t.getStorage({key:"selectAddress",success:function(t){console.log("地址",t),e.recinfo=t.data}})},filters:{toFixed:function(t){return parseFloat(t).toFixed(2)}},methods:{getAddress:function(){var t=this;this.$xm.post("/Order/getDefAdr/","",function(e){console.log(e),t.recinfo=e})},loadData:function(){var t=this,e={store:this.store};this.$xm.post("/Cart",e,function(e){t.word=e.word;var i=e.prolist,s=e.allprice;t.$xm.requestImg(i),t.buylist=i,t.minprice=Number(e.minprice),t.goodsPrice=e.allprice,t.tips=e.tips,t.payPrice=Number(s),t.minprice>t.payPrice&&(t.goodsPrice=t.payPrice+t.freight),t.discounts(e.allprice)})},discounts:function(t){var e=this,i={store:this.store,money:t};this.$xm.post("/Coupon/match_optimals",i,function(t){if(t.data){e.sumPrice=t.data.money;var i=t.data.money;e.payLing=Number(i),e.minprice>e.payLing&&(e.sumPrice=e.payLing+e.freight),e.tips=t.data.msg,e.disPrice=t.data.cut,e.disType=t.data.type,e.getship()}})},getship:function(){var e=this;if(this.recinfo){var i={shipid:this.recinfo.id,allprice:this.payLing,store:this.store};this.$xm.post("/Order/getShipMoney",i,function(t){console.log(t),void 0!==t.data&&(t.data.constructor==Array?(e.items=t.data,e.items.forEach(function(t){t.checked=""}),e.items[0].checked=!0,e.ship_name=e.items[0].name,e.shipmoney=e.items[0].price,e.freight=e.items[0].price):(e.items=[],e.freight=t.data.price,e.shipmoney=t.data.price,e.ship_name=t.data.name))})}else t.showToast({title:"请选择收件地址！",icon:!1})},shipChange:function(t){var e;this.ship_name=t.detail.value,"普通快递"==t.detail.value?(e=0,this.shipmoney=5):"顺丰快递"==t.detail.value?(e=1,this.shipmoney=15):"满59包邮"==t.detail.value&&(e=0,this.shipmoney=0),this.freight=this.items[e].price,this.goodsPrice=this.payPrice+this.freight,this.sumPrice=this.payLing+this.freight},toPay:function(){var e={shipid:this.recinfo.id,shipmoney:this.shipmoney,ship_name:this.ship_name,memo:this.note,couponid:"",store:this.store};this.$xm.post("/Order/saveOrder",e,function(e){var i=e.data;1==e.s?t.requestPayment({timeStamp:i.timeStamp,nonceStr:i.nonceStr,package:i.package,signType:i.signType,paySign:i.paySign,success:function(t){console.log(t)},fail:function(t){console.log(t)},complete:function(e){"requestPayment:ok"==e.errMsg?t.showModal({title:"支付成功！",content:"",showCancel:!1,confirmText:"确  定",confirmColor:"#2c2c2c",success:function(e){t.redirectTo({url:"../user/order_list/order_list?tbIndex=1"})}}):t.showModal({title:"支付失败！",content:"",showCancel:!1,confirmText:"确  定",confirmColor:"#2c2c2c",success:function(t){t.confirm&&wx.redirectTo({url:"../user/order_list/order_list?tbIndex=0"})}})}}):t.showToast({title:e.msg,icon:"none"})})},selectAddress:function(){t.navigateTo({url:"../user/address/address?type=select"})}}};e.default=i}).call(this,i("543d")["default"])},"664c":function(t,e,i){"use strict";(function(t){i("e146"),i("921b");s(i("66fd"));var e=s(i("fcc6"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},7846:function(t,e,i){"use strict";var s,n=function(){var t=this,e=t.$createElement;t._self._c},o=[];i.d(e,"b",function(){return n}),i.d(e,"c",function(){return o}),i.d(e,"a",function(){return s})},f299:function(t,e,i){},fcc6:function(t,e,i){"use strict";i.r(e);var s=i("7846"),n=i("3a0d");for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);i("319d");var r,c=i("f0c5"),a=Object(c["a"])(n["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],r);e["default"]=a.exports}},[["664c","common/runtime","common/vendor"]]]);
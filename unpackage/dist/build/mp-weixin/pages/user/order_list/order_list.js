(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/order_list/order_list"],{"1db9":function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){return s.e("components/modal/modal").then(s.bind(null,"8214"))},o={components:{tuiModal:n},data:function(){return{secret:{},pageid:1,status:"",headerPosition:"fixed",headerTop:"0px",orderType:[{name:"全部",sort:"s"},{name:"未付款",sort:"0"},{name:"已付款",sort:"1"},{name:"配货中",sort:"2"},{name:"已发货",sort:"3"},{name:"已收货",sort:"4"},{name:"已作废",sort:"5"},{name:"已删除",sort:"6"},{name:"已退款",sort:"8"}],orderList:[],list:[],tabbarIndex:0,scrollLeft:0,txt:"",txtmodal:!1,refundList:[],loadingText:"正在加载中..."}},onLoad:function(e){var s=this;this.tabbarIndex=e.tbIndex,t.getStorage({key:"user",success:function(t){s.secret=t.data,s.getlist()}})},onShow:function(){},onPageScroll:function(t){},methods:{getlist:function(){var t=this,e={xopenid:this.secret.openid,pageid:this.pageid,status:"s"!=this.tabbarIndex?this.tabbarIndex:"",secret:this.secret.secret,timestamp:this.secret.timestamp};this.$xm.post("/Order/getList",e,function(e){e.orderlist.length>0&&e.orderlist.forEach(function(e){switch(t.$xm.requestImg(e.pro),e.order_state){case"0":e.tips="未付款";break;case"1":e.tips="已付款";break;case"2":e.tips="配货中";break;case"3":e.tips="已发货";break;case"4":e.tips="已收货";break;case"5":e.tips="已作废";break;case"6":e.tips="已删除";break;case"7":e.tips="已退款";break;case"8":e.tips="已退款";break;default:}}),t.list=e.orderlist,t.loadingText="到底了"})},showType:function(t){t||(t="s"),this.tabbarIndex=t,this.getlist()},toOrderDtl:function(e){console.log(e),t.navigateTo({url:"./orderDtl/orderDtl?id="+e})},showLogistics:function(t){},buyAgain:function(e){var s={xopenid:this.secret.openid,ordersn:e.order_sn,secret:this.secret.secret,timestamp:this.secret.timestamp};this.$xm.post("/Order/buyAgain",s,function(e){1==e.s&&t.navigateTo({url:"../../order/confirmation"})})},edit:function(e){t.navigateTo({url:"./orderEdit/orderEdit?sn="+e.order_sn})},modalShow:function(t){this.txtmodal=!0,this.refundList=t},refund:function(){var e=this;console.log(this.refundList),this.txtmodal=!1;var s=this;t.showModal({title:"确定要申请退款吗",content:"申请后不可恢复",success:function(n){if(n.confirm){var o={status:7,xopenid:e.secret.openid,ordersn:e.refundList.order_sn,secret:e.secret.secret,timestamp:e.secret.timestamp,memo:e.txt};e.$xm.post("/Order/changeStatus",o,function(e){1==e.s?(t.showToast({title:"申请成功"}),setTimeout(function(){s.getlist()},500)):t.showToast({title:"申请失败"})})}else n.cancel&&t.showToast({title:"申请失败"})}})},del:function(e){var s=this,n={xopenid:this.secret.openid,ordersn:e.order_sn,secret:this.secret.secret,timestamp:this.secret.timestamp,status:"6"};this.$xm.post("/Order/changeStatus",n,function(e){console.log(e),1==e.s?(s.getlist(),t.showToast({title:"删除成功"})):t.showToast({title:"删除失败"})})},remindDeliver:function(e){t.showToast({title:"已提醒商家发货"})},cancelOrder:function(e){var s=this;t.showModal({title:"取消订单",content:"确定取消此订单？",success:function(t){t.confirm?(console.log("用户点击确定"),s.doCancelOrder(e.ordersn)):t.cancel&&console.log("用户点击取消")}})},doCancelOrder:function(t){for(var e=this.orderList.length,s=0;s<e;s++){var n=this.orderList[s],o=n.length;if(o>0&&"unpaid"==n[0].type)for(var r=0;r<o;r++)if(this.orderList[s][r].ordersn==t){this.orderList[s][r].type="cancelled";break}}},toPayment:function(e){var s={xopenid:this.secret.openid,order_sn:e.order_sn,secret:this.secret.secret,timestamp:this.secret.timestamp};this.$xm.post("/Order/rePay",s,function(e){if(1==e.s){var s=e.data;t.requestPayment({timeStamp:s.timeStamp,nonceStr:s.nonceStr,package:s.package,signType:s.signType,paySign:s.paySign,success:function(t){console.log(t)},fail:function(t){console.log(t)},complete:function(e){"requestPayment:ok"==e.errMsg?t.showModal({title:"支付成功！",content:"",showCancel:!1,confirmText:"确  定",confirmColor:"#2c2c2c",success:function(t){that.getlist()}}):t.showModal({title:"支付失败！",content:"",showCancel:!1,confirmText:"确  定",confirmColor:"#2c2c2c",success:function(t){t.confirm}})}})}else t.showToast({title:e.msg,icon:"none"})})},toPage:function(){t.navigateTo({url:"./orderDtl/orderDtl"})}}};e.default=o}).call(this,s("543d")["default"])},5444:function(t,e,s){"use strict";s.r(e);var n=s("1db9"),o=s.n(n);for(var r in n)"default"!==r&&function(t){s.d(e,t,function(){return n[t]})}(r);e["default"]=o.a},5944:function(t,e,s){"use strict";(function(t){s("e146"),s("921b");n(s("66fd"));var e=n(s("703d"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,s("543d")["createPage"])},"703d":function(t,e,s){"use strict";s.r(e);var n=s("cdde"),o=s("5444");for(var r in o)"default"!==r&&function(t){s.d(e,t,function(){return o[t]})}(r);s("e595");var i,a=s("f0c5"),c=Object(a["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],i);e["default"]=c.exports},ca54:function(t,e,s){},cdde:function(t,e,s){"use strict";var n,o=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.txtmodal=!1})},r=[];s.d(e,"b",function(){return o}),s.d(e,"c",function(){return r}),s.d(e,"a",function(){return n})},e595:function(t,e,s){"use strict";var n=s("ca54"),o=s.n(n);o.a}},[["5944","common/runtime","common/vendor"]]]);